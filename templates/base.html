{% load staticfiles %}
{% load compress %}
{% load blog_tags static %}
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="baidu-tc-verification" content="0fb041a64ee71333c957d8c784961cc8"/>
    <meta property="qc:admins" content="145637425211673116375"/>
    <meta http-equiv="X-UA-Compatible" content="IE=10,IE=9,IE=8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <!-- All in One SEO Pack 2.3.12.2.1 by Michael Torbert of Semper Fi Web Design[392,409] -->

    {% block description %}
    {% endblock description %}
    {% block keywords %}
    {% endblock keywords %}
    <link rel="icon" href="{% static 'images/picture.ico' %}" type="image/x-icon"/>
    <title>
        {% block title %}{% endblock title %}
    </title>
    <script>
        window._deel = {name: '渡', url: '/', ajaxpager: 'on', commenton: 0, roll: [11, 12]}
        window._deel.commenton=1
    </script>
    <link rel='stylesheet' id='style-css' href='https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css'
          type='text/css' media='all'/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">

    <script type='text/javascript' src='https://libs.baidu.com/jquery/1.8.3/jquery.min.js?ver=1.0'></script>
    <script type='text/javascript' src='https://cuiqingcai.com/wp-content/themes/Yusi/js/jquery.js?ver=1.0'></script>
    {% block head %}{% endblock head %}
    <!-- /all in one seo pack -->
    {% compress css %}
        <link href="{% static 'comment/css/base_comment.css' %}?v=20180114.008" rel="stylesheet">
        <link type="text/css" href="{% static 'comment/css/style_1_common.css' %}" rel="stylesheet">
        <link rel='stylesheet' id='crayon-css' href='{% static 'css/crayon.min.css' %}' type='text/css' media='all'/>
        <link rel='stylesheet' id='crayon-font-monaco-css' href='{% static 'css/monaco.css' %}' type='text/css'
              media='all'/>
        <link rel='stylesheet' id='page-list-style-css' href='{% static 'css/page-list.css' %}' type='text/css'
              media='all'/>
        <link rel='stylesheet' id='l2h_style-css' href='{% static 'css/latex.min.css' %}' type='text/css'
              media='screen, print'/>
        <link rel='stylesheet' id='l2h_print_style-css' href='{% static 'css/print.min.css' %}' type='text/css'
              media='print'/>
        <link rel='stylesheet' id='style-css' href='{% static 'css/style.css' %}' type='text/css' media='all'/>
        <link rel="stylesheet" href="{% static 'highlights/zenburn.css' %}">
        <link rel='stylesheet' id='metaslider-nivo-slider-css' href='{% static 'css/nivo-slider.css' %}' type='text/css'
              media='all' property='stylesheet'/>
        <link rel='stylesheet' id='metaslider-public-css' href='{% static 'css/public.css' %}' type='text/css'
              media='all'
              property='stylesheet'/>
        <link rel='stylesheet' id='metaslider-nivo-slider-bar-css' href='{% static 'css/bar.css' %}' type='text/css'
              media='all'
              property='stylesheet'/>
    {% endcompress %}
    {% compress js %}
        <script type='text/javascript' src='{% static 'js/crayon.min.js' %}'></script>
        <script type='text/javascript' src='{% static 'js/jquery.fitvids.js' %}'></script>
        <!--[if lt IE 9]><script src="{% static 'js/html5.js' %}"></script><![endif]-->
        <script type='text/javascript' src='{% static 'js/wp-embed.min.js' %}'></script>
        <script type='text/javascript' src='{% static 'js/jquery.nivo.slider.pack.js' %}'></script>
    {% endcompress %}
    <!--评论区，富文本编辑器-->
    <meta name="keywords" content="StormSha,storm,静觅,爬虫,Python,C,Java,Django,HTML,JS,教程">
    <meta name="description" content="StormSha的个人主页">
    <script type="text/javascript">
        jQuery(document).ready(function () {
            jQuery('.video').fitVids();
        });
    </script>
    <!--百度统计-->
    <script type="text/javascript"></script>
    <style>
        *{
            padding:0;
            margin:0
        }
    </style>
</head>

<body class="home blog">
<div class="page">
<header id="header" class="header">
    <div class="container-inner">
        <!--头部-->
        <div class="yusi-logo">
            <a href="/">
                <h1>
                    <span class="yusi-mono">渡</span>
                    <span class="yusi-bloger">StormSha的个人博客</span>
                </h1>
            </a>
        </div>

        <!--导航条-->
        <div id="nav-header" class="navbar">
            <ul class="nav">
                <!--获取一级分类信息-->
                {% get_bigcategory_list as bigcategory %}
                <li id="menu-item-44"
                    class="menu-item menu-item-type-custom menu-item-object-custom {% if not category %}current-menu-item current_page_item{% endif %} menu-item-home menu-item-44">
                    <a
                            href="/">首页</a></li>

                <!--导航条一级分类渲染-->
                {% for big in bigcategory %}

                    <!--获取二级分类信息-->
                    {% get_category_list big.id as cate %}

                    <!--如果一级分类下有二级分类则进行渲染-->
                    {% if cate %}
                        <li id="menu-item-14"
                            class="menu-item menu-item-type-taxonomy menu-item-object-category {% if category == big.slug %}current-menu-item {% endif %} menu-item-has-children menu-item-14">
                            <a href="{% url 'blog:category' big.slug '' %}">{{ big.name }}</a>
                            <ul class="sub-menu">
                                <!--导航条二级分类渲染-->
                                {% for c in cate %}
                                    <li id="menu-item-19"
                                        class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-19">
                                        <a href="{% url 'blog:category'  big.slug   c.slug %}">{{ c.name }}</a></li>
                                {% endfor %}
                            </ul>
                        </li>

                        <!--无二级分类的一级分类渲染-->
                    {% else %}
                        <li id="menu-item-851"
                            class="menu-item menu-item-type-post_type menu-item-object-page {% if category == big.slug %}current-menu-item {% endif %} menu-item-851">
                            <a href="{% url 'blog:category' big.slug '' %}">{{ big.name }}</a></li>
                    {% endif %}
                {% endfor %}
                <!--导航条结束-->

                <!--搜索框-->
                <li style="float:right;">
                    <div class="toggle-search"><i class="fa fa-search"></i></div>
                    <div class="search-expand">
                        <div class="search-expand-inner">
                            <form class="nav-item navbar-form mr-2 py-md-2" role="search" method="get" id="searchform"
                                  action="{% url 'blog:search' %}">
                                <div class="input-group">
                                    <input type="search" name="q" class="search" placeholder="搜索" required=True>
                                    <button class="search" type="submit" style="position: absolute;height: 30px"><i
                                            class="fa fa-search"></i></button>
                                </div><!-- /input-group -->
                            </form>
                        </div>
                    </div>
                </li>
                <!--搜索框结束-->

            </ul>
        </div>
        <!--导航条结束-->
    </div>
</header>

<section class="container">

    <div class="speedbar" id="speedbar">
        <!--登录-->
        <!--目前登录功能只有注册登录其它没必要没做-->
        {% include 'oauth/user.html' %}
        <!--登录注册结束-->
        <!--公告-->
        <div class="toptip"><strong class="text-success"><i class="fa fa-volume-up"></i> </strong>{% get_active %}</div>
        <!--公告结束-->
    </div>

    <!--右侧内容区-->
    {% block body %}{% endblock body %}
    <!--左侧内容区结束-->

    <!--右侧信息标签广告区-->

    {% block right %}{% endblock %}
    <script type='text/javascript' src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
    <script type='text/javascript' src="/static/comment/js/editor.js"></script>
    <script type='text/javascript' src="{% static 'comment/js/activate-power.js' %}?v=20180120"></script>
    <script>
        var sw = window.screen.width;
        if (sw > 1200) {
            POWERMODE.colorful = true;
            POWERMODE.shake = false;
            document.body.addEventListener('input', POWERMODE)
        }
    </script>
</section>
<!--网站底部-->
<footer class="footer" style="flex: 0 0 auto;">
    <div class="footer-inner">
        <div class="copyright pull-left">
            <a href="/" title="静觅">StormSha</a> 版权所有丨采用
            <a href="http://yusi123.com/"> 欲思 </a>主题丨
            <a href="https://www.djangoproject.com/" title="Django" target="_blank">基于Django构建</a>© 2019丨托管于
            <a rel="nofollow" target="_blank" href="https://www.aliyun.com/" title="阿里云主机" target="_blank">腾讯云主机</a> &
            <a rel="nofollow" target="_blank" href="https://www.qiniu.com/">七牛云存储 </a>丨
            <a href="/sitemap.xml" title="Sitemap" target="_blank">网站地图</a>
        </div>

    </div>
</footer>
</div>
<!--网站底部结束-->
<!--侧边栏跟随-->
<script type="text/javascript">
    SidebarFollow = function () {
        this.config = {
            element: null, // 处理的节点
            compare: null,
            distanceToTop: 0, // 节点上边到页面顶部的距离
            _distanceRight: 0
        };
        this.cache = {
            originalToTop: 0, // 原本到页面顶部的距离
            prevElement: null, // 上一个节点
            parentToTop: 0, // 父节点的上边到顶部距离
            placeholder: document.createElement('div') // 占位节点
        }
    };
    SidebarFollow.prototype = {
        init: function (config) {
            this.config = config || this.config;
            var _self = this;
            var element = document.getElementById(_self.config.element);
            // 如果没有找到节点, 不进行处理
            if (!element) {
                return;
            }
            // 获取上一个节点
            var _prevElement = _self._getPrevElement(element);
            var prevElement = _self._getPrevElement(_prevElement);
            while (prevElement.offsetHeight < 0) {
                prevElement = _self._getPrevElement(prevElement);
                if (!prevElement) {
                    break;
                }
            }
            _self.cache.prevElement = prevElement;
            // 计算父节点的上边到顶部距离
            var parent = element.parentNode;
            var parentToTop = _self._getCumulativeOffset(parent).top;
            var parentBorderTop = parseInt(parent.style.borderTop, 10);
            var parentPaddingTop = parseInt(parent.style.paddingTop, 10);
            _self.cache.parentToTop = parentToTop + parentBorderTop + parentPaddingTop;
            // 滚动屏幕
            var speed_bar = document.getElementById(_self.config.compare);
            _self.config._distanceRight = document.body.clientWidth - _self._getCumulativeOffset(element).right;
            element.style.position = 'static';
            if (_self.config._distanceRight < 0){
                element.style.right = 0 - _self.config._distanceRight + 'px';
            }else {
                element.style.right = _self.config._distanceRight + 'px';
            }
            _self._addListener(window, 'scroll', function () {
                _self._scrollScreen({element: element, speed_bar: speed_bar, prevElement: prevElement, _self: _self});
            });
            // 改变屏幕尺寸
            _self._addListener(window, 'resize', function () {
                _self._scrollScreen({element: element, speed_bar: speed_bar, prevElement: prevElement, _self: _self});
            });
        },
        _scrollScreen: function (args) {
            var _self = args._self;
            var element = args.element;
            var speed_bar = args.speed_bar;
            var prevElement = args.prevElement;
            var toTop = _self.config.distanceToTop;
            var parentToBottom = _self._getCumulativeOffset(element).bottom;
            // 如果 body 有 top 属性, 消除这些位移
            var bodyToTop = parseInt(document.getElementsByTagName('body')[0].style.top, 10);
            if (!isNaN(bodyToTop)) {
                toTop += bodyToTop;
            }
            var elementToTop = 0;
            if (element.style.position === 'fixed') {
                elementToTop = _self._getScrollY();
            } else {
                elementToTop = _self._getCumulativeOffset(element).top - toTop;
            }
            var elementToPrev = _self._getCumulativeOffset(prevElement).top + _self._getVisibleSize(prevElement).height;
            // 当节点进入跟随区域, 跟随滚动
            var distanceRight = document.body.clientWidth - _self._getCumulativeOffset(speed_bar).right;
            if (distanceRight != _self.config._distanceRight || distanceRight < 0){
                if (distanceRight < 0){
                    element.style.right = - distanceRight  + 'px';
                }else {
                    element.style.right = distanceRight  + 'px';
                }
            }
            if (_self._getScrollY() > elementToTop + parentToBottom) {
                // 添加占位节点
                var elementHeight = _self._getVisibleSize(element).height;
                _self.cache.placeholder.style.height = elementHeight + 'px';
                element.parentNode.insertBefore(_self.cache.placeholder, element);
                // 记录原位置
                _self.cache.originalToTop = elementToTop;
                // 修改样式
                element.style.bottom = 0;
                element.style.position = 'fixed';
                {#while ()#}
                element.style.right = distanceRight  + 'px';
                // 否则回到原位
            } else if (_self.cache.originalToTop > elementToTop || elementToPrev > elementToTop) {
                var parent = _self.cache.placeholder.parentNode;
                if (parent) {
                    // 删除占位节点
                    parent.removeChild(_self.cache.placeholder);
                    // 修改样式
                    element.style.position = 'static';
                }
            }
        },
        _getCumulativeOffset: function (element) {
            var rect = element.getBoundingClientRect();
            var offset = {
                left: 0,
                top: 0,
                right: rect.right - document.documentElement.clientLeft,
                bottom: rect.bottom - document.documentElement.clientTop
            };
            do {
                offset.left += element.offsetLeft || 0;
                offset.top += element.offsetTop || 0;
                element = element.offsetParent;
            } while (element);
            return offset;
        },

        _getVisibleSize: function (element) {
            var dimension = {
                width: 0,
                height: 0
            };
            dimension.width = element.offsetWidth;
            dimension.height = element.offsetHeight;
            return dimension;
        },

        _getScrollY: function () {
            if (typeof window.pageYOffset != 'undefined') {
                return window.pageYOffset;
            }
            if (typeof document.compatMode != 'undefined' && document.compatMode != 'BackCompat') {
                {#return document.documentElement.scrollTop;#}
                return document.documentElement.scrollTop;
            }
            return document.body.scrollTop;
        },

        _addListener: function (node, type, listener) {
            if (node.addEventListener) {
                node.addEventListener(type, listener, false);
                return true;
            } else if (node.attachEvent) {
                node['e' + type + listener] = listener;
                node[type + listener] = function () {
                    node['e' + type + listener](window.event);
                };
                node.attachEvent('on' + type, node[type + listener]);
                return true;
            }
            return false;
        },

        _getPrevElement: function (element) {
            var prev = element.previousSibling;
            while (prev.nodeType !== 1) {
                prev = prev.previousSibling;
            }
            return prev;
        }
    };
</script>
<script>
    (new SidebarFollow()).init({
        element: 'sidebar',
        compare: 'speedbar',
        distanceToTop: 0
    });
</script>
</body>
</html>

